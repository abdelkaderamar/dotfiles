#! /bin/bash

### Colors ################################################
RED='\033[0;31m'
GREEN='\033[0;32m'
BROWN='\033[0;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
YELLOW='\033[1;33m'
NC='\033[0m'

### Logging ################################################
function e_header()  { echo -e "\n\033[1m$@\033[0m"; }
function e_success() { echo -e " \033[1;32m✔\033[0m  $@"; }
function e_error()   { echo -e " \033[1;31m✖\033[0m  $@"; }
function e_arrow()   { echo -e " \033[1;34m➜\033[0m  $@"; }
function e_warn()    { echo -e " \033[1;31m➜\033[0m  $@"; }
function echo_and_exit()
{
  exit_code=$1
  shift
  e_error "$@"
  exit $exit_code
}

### Create a directory than move all the files passed as
### parameter to it
function dirndmv()
{
  if [ $# -lt 2 ]
  then
    e_error 'Usage: dirndmv.sh <dir> {files}'
    return 1
  fi

  dir="$1"
  shift

  mkdir -p "$dir" && mv -vi "$@" "$dir"
}

function gpull_all()
{
  if [ $# -eq 0 ]
  then
    set -- *
  fi
    for i in "$@"
    do
      if [ -d "$i" ]
      then
        echo "$i"
        cd "$i"
        git pull
        cd - > /dev/null
      fi
    done
}

function gstatus_all()
{
  if [ $# -eq 0 ]
  then
    set -- *
  fi
    for i in "$@"
    do
      if [ -d "$i" ]
      then
        cd "$i"
        res=$(git status -s)
        if [ ! -z "$res" ]
        then
          e_arrow "$i modified file(s):"
          echo "$res"
          echo
        fi

        cd - > /dev/null
      fi
    done
}

function unpushed_commit()
{
  if [ $# -eq 0 ]
  then
    set -- *
  fi
    for i in "$@"
    do
      if [ -d "$i" ]
      then
        #echo "$i"
        cd "$i"
        res=$(git log origin/master..HEAD)
        if [ ! -z "$res" ]
        then
          e_arrow "$i unpublished commit(s):"
          echo "$res"
          echo
        fi
        cd - > /dev/null
      fi
    done
}

### Convert code to latex compatible text
function code2tex()
{
  for i in "$@"
  do
    echo $i | sed 's/\([{}_$]\)/\\\1/g'
  done
}
